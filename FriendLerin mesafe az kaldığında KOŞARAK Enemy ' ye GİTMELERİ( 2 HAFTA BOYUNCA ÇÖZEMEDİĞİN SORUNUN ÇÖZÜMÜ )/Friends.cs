using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.AI;

public class Friends : MonoBehaviour
{

    public GameObject Character;
    [SerializeField] List<GameObject> E_enemys = new List<GameObject>();
    [SerializeField] Animator F_Anim;

    [SerializeField] float IdentifierDistance;
    [SerializeField] float f_DeathDistance;

    [SerializeField] bool IsMySelfContact;
    [SerializeField] bool IsCharacterContact;

    Touch AllTouch;




    void Start()
    {

        IsMySelfContact = false;
        IsCharacterContact = false;

    }



    private void Update()
    {

        if (IsCharacterContact)
        {
            CharacterAndFriendContact();
        }

        if (IsMySelfContact)
        {
            FriendAndFriendContact();
        }



    }


    private void OnTriggerEnter(Collider other)
    {

        if (other.gameObject.transform.CompareTag("Character"))
        {

            IsCharacterContact = true;
        }


        if (other.gameObject.transform.CompareTag("Player"))
        {


            IsMySelfContact = true;
        }

        if (other.gameObject.transform.CompareTag("Enemy"))
        {
            F_Anim.Play("Death");
            Destroy(gameObject, 0.2f);

        }

    }


    void CharacterAndFriendContact()
    {

        Character.transform.position = new Vector3(Character.transform.position.x, 0f, Character.transform.position.z);
        gameObject.transform.SetParent(Character.transform);

        Vector3 aBs = Character.transform.eulerAngles;
        gameObject.transform.rotation = Quaternion.Euler(aBs.x, aBs.y, aBs.z);


        AllAnimasyonController();


    }


    void FriendAndFriendContact()
    {

        Character.transform.position = new Vector3(Character.transform.position.x, 0f, Character.transform.position.z);
        gameObject.transform.SetParent(Character.transform);

        Vector3 RBs = Character.transform.eulerAngles;
        gameObject.transform.rotation = Quaternion.Euler(RBs.x, RBs.y, RBs.z);


        AllAnimasyonController();

    }


    void AllAnimasyonController()
    {

        if (Input.touchCount > 0)
        {

            AllTouch = Input.GetTouch(0);

            if (AllTouch.phase == TouchPhase.Began)
            {
                F_Anim.SetBool("IsRush", true);
            }

            if (AllTouch.phase == TouchPhase.Moved)
            {
                F_Anim.SetBool("IsRush", true);
            }

            if (AllTouch.phase == TouchPhase.Stationary)
            {
                F_Anim.SetBool("IsRush", true);

            }

            if (AllTouch.phase == TouchPhase.Ended)
            {
                F_Anim.SetBool("IsRush", false);

            }


        }





    }



    #region BU SCRÝPTÝ ÝLERDE SÝLMEN GEREKEN BÝR DURUM OLURSA BÝLE BU YAZDIÐIM ÞEYLERÝ SAKIN SÝLME - 1  *****************************

    /*

     Enemy ve Friend 'leri DÝZÝ içerisine tanýmlamýþtýk :

     Menzile girdiði zaman Enemy ve Friend Birbirine koþuyor ölme animasyonlarý gerçekleþiyor ve daha sonra bunlarý yok
     ediyorduk.Ancak TAM BU NOKTADA sen bu 2 objeyi yok ettin ancak 2 TANE ÝÇ ÝÇE GEÇMÝÞ FOR DÖNGÜSÜNDE BU objelere
     TEKRAR ULAÞMAYA ÇALIÞIYORSUN HATASINI ALIYORDUN tam 1 HAFTA BOYUNCA BU HATAYI ÇÖZEMEDÝN.

     BU HATAYI ÞÖYLE ÇÖZDÜM  : 

     DÝZÝLERDE  ELEMAN SAYISI BELLÝ OLMAK ZORUNDADIR YANÝ 5 SE OYUNDAN ÝSTER ÖLDÜRME ÝSTER BAÞKA AKSÝYON OLSUN BU DÝZÝ 5 
     ELEMANLI OLARAK DEVAM ETMEK ZORUNDADIR.

     ANCAK biz  LÝST 'LERÝ KULLANIRSAK BU LÝST ' LERDE ELEMAN SAYISI BELLÝ DEÐÝLDÝR OYUNLARDA  ÖLDÜRME VEYA DÝÐER AKSÝYONLARA
     GÖRE ELEMAN SAYISI(ÝSTEDÝÐÝMÝZ YERDE ARTIRABÝLÝR ÝSTEDÝÐÝMÝZ YERDE ) AZALTABÝLÝRÝZ !!!!!!!!!!!!!!!!!!!!!!!!!!


    */

    #endregion


    #region BU SCRÝPTÝ ÝLERDE SÝLMEN GEREKEN BÝR DURUM OLURSA BÝLE BU YAZDIÐIM ÞEYLERÝ SAKIN SÝLME 2 *****************************

    /*

     Hem Really_Meet ' deki Scriptindeki bu kýsmý SAKIN SÝLME HEMDE BU YAZDIKLARIMI SAKIN SÝLME.

     Þimdi sen bazý durumlarda ETKÝLEÞÝMLERÝ  MESAFEDEN  yakalaman gereken durumlar olabilir. Ancak bu durumlarda
     Eðer DEBUG  edersen  o durumun MESAFEDEN yapýlabilip yapýlamadýðýný ANLARSIN. 


    */

    #endregion


    #region 3 haftadýr 2 tane Friend ' in ayný anda Enemy ' e  gitme sorunun çözümünü anlatan KISIM 

    /*

     mesafe 'yi Death distance ' dan küçük olduktan sonra silmedin DÝREK BU HALÝYLE YAPTIN. çünkü diðer denemelerinde hepsinde
     mesafe 1 ' den küçük olduðunda yok olup listelerden siliniyolardý. Þimdi burda ÖYLE BÝR ÞEY YOK  TRÝGGER olduklarýnda
     kendi ( Friends ve Enemys) Scriptlerindeki kodlarýn sayesinde DÝREK SÝLÝNÝP ölecekler.BÖYLECE 3 HAFTADIR ALDIÐIN HATAYI
     ÇÖZMÜÞ OLDUN . !!!  

    */


    #endregion





}
